{"version":3,"file":"facade.js","names":["_model","require","_runtime","_utils","callRuntimeMethod","method","_len","arguments","length","args","Array","_key","runtime","getGlobalTestRuntimeWithAutoconfig","isPromise","then","testRuntime","label","name","value","exports","labels","_len2","labelsList","_key2","link","url","type","links","_len3","linksList","_key3","parameter","options","description","markdown","descriptionHtml","html","displayName","historyId","testCaseId","attachment","content","opts","contentType","globalAttachment","globalAttachmentPath","path","globalError","details","attachTrace","attachmentPath","stepContext","mode","logStep","status","error","step","body","issue","LinkType","ISSUE","tms","TMS","allureId","LabelName","ALLURE_ID","epic","EPIC","feature","FEATURE","story","STORY","suite","SUITE","parentSuite","PARENT_SUITE","subSuite","SUB_SUITE","owner","OWNER","severity","SEVERITY","layer","LAYER","tag","TAG","tags","_len4","tagsList","_key4","map"],"sources":["../../src/facade.ts"],"sourcesContent":["import type { Status, StatusDetails } from \"./model.js\";\nimport { type ContentType } from \"./model.js\";\nimport { type AttachmentOptions, type Label, type Link, type ParameterMode, type ParameterOptions } from \"./model.js\";\nimport { LabelName, LinkType } from \"./model.js\";\nimport { getGlobalTestRuntimeWithAutoconfig } from \"./sdk/runtime/runtime.js\";\nimport type { TestRuntime } from \"./sdk/runtime/types.js\";\nimport { isPromise } from \"./sdk/utils.js\";\n\nconst callRuntimeMethod = <\n  T extends keyof TestRuntime,\n  S extends Parameters<TestRuntime[T]>,\n  R extends ReturnType<TestRuntime[T]>,\n>(\n  method: T,\n  ...args: S\n): R => {\n  const runtime = getGlobalTestRuntimeWithAutoconfig();\n\n  if (!isPromise(runtime)) {\n    // @ts-ignore\n    return runtime[method](...args);\n  }\n\n  return runtime.then((testRuntime) => {\n    // @ts-ignore\n    return testRuntime[method](...args);\n  }) as R;\n};\n\nexport const label = (name: LabelName | string, value: string) => {\n  return callRuntimeMethod(\"labels\", { name, value });\n};\n\nexport const labels = (...labelsList: Label[]) => {\n  return callRuntimeMethod(\"labels\", ...labelsList);\n};\n\nexport const link = (url: string, name?: string, type?: LinkType | string) => {\n  return callRuntimeMethod(\"links\", { url, type, name });\n};\n\nexport const links = (...linksList: Link[]) => {\n  return callRuntimeMethod(\"links\", ...linksList);\n};\n\nexport const parameter = (name: string, value: string, options?: ParameterOptions) => {\n  return callRuntimeMethod(\"parameter\", name, value, options);\n};\n\nexport const description = (markdown: string) => {\n  return callRuntimeMethod(\"description\", markdown);\n};\n\nexport const descriptionHtml = (html: string) => {\n  return callRuntimeMethod(\"descriptionHtml\", html);\n};\n\nexport const displayName = (name: string) => {\n  return callRuntimeMethod(\"displayName\", name);\n};\n\nexport const historyId = (value: string) => {\n  return callRuntimeMethod(\"historyId\", value);\n};\n\nexport const testCaseId = (value: string) => {\n  return callRuntimeMethod(\"testCaseId\", value);\n};\n\nexport const attachment = (\n  name: string,\n  content: Buffer | string,\n  options: ContentType | string | AttachmentOptions,\n) => {\n  const opts = typeof options === \"string\" ? { contentType: options } : options;\n  return callRuntimeMethod(\"attachment\", name, content, opts);\n};\n\nexport const globalAttachment = (\n  name: string,\n  content: Buffer | string,\n  options: ContentType | string | AttachmentOptions,\n) => {\n  const opts = typeof options === \"string\" ? { contentType: options } : options;\n  return callRuntimeMethod(\"globalAttachment\", name, content, opts);\n};\n\nexport const globalAttachmentPath = (\n  name: string,\n  path: string,\n  options: ContentType | string | Omit<AttachmentOptions, \"encoding\">,\n) => {\n  const opts = typeof options === \"string\" ? { contentType: options } : options;\n  return callRuntimeMethod(\"globalAttachmentFromPath\", name, path, opts);\n};\n\nexport const globalError = (details: StatusDetails) => {\n  return callRuntimeMethod(\"globalError\", details);\n};\n\nexport const attachTrace = (name: string, path: string) => {\n  return callRuntimeMethod(\"attachmentFromPath\", name, path, {\n    contentType: \"application/vnd.allure.playwright-trace\",\n  });\n};\n\nexport const attachmentPath = (\n  name: string,\n  path: string,\n  options: ContentType | string | Omit<AttachmentOptions, \"encoding\">,\n) => {\n  const opts = typeof options === \"string\" ? { contentType: options } : options;\n  return callRuntimeMethod(\"attachmentFromPath\", name, path, opts);\n};\n\nexport type StepContext = {\n  displayName: (name: string) => void | PromiseLike<void>;\n  parameter: (name: string, value: string, mode?: ParameterMode) => void | PromiseLike<void>;\n};\n\nconst stepContext: () => StepContext = () => ({\n  displayName: (name: string) => {\n    return callRuntimeMethod(\"stepDisplayName\", name);\n  },\n  parameter: (name, value, mode?) => {\n    return callRuntimeMethod(\"stepParameter\", name, value, mode);\n  },\n});\n\nexport const logStep = (name: string, status?: Status, error?: Error): PromiseLike<void> => {\n  return callRuntimeMethod(\"logStep\", name, status, error);\n};\n\nexport const step = <T = void>(name: string, body: (context: StepContext) => T | PromiseLike<T>): PromiseLike<T> => {\n  return callRuntimeMethod(\"step\", name, () => body(stepContext()));\n};\n\nexport const issue = (url: string, name?: string) => link(url, name, LinkType.ISSUE);\n\nexport const tms = (url: string, name?: string) => link(url, name, LinkType.TMS);\n\nexport const allureId = (value: string) => label(LabelName.ALLURE_ID, value);\n\nexport const epic = (name: string) => label(LabelName.EPIC, name);\n\nexport const feature = (name: string) => label(LabelName.FEATURE, name);\n\nexport const story = (name: string) => label(LabelName.STORY, name);\n\nexport const suite = (name: string) => label(LabelName.SUITE, name);\n\nexport const parentSuite = (name: string) => label(LabelName.PARENT_SUITE, name);\n\nexport const subSuite = (name: string) => label(LabelName.SUB_SUITE, name);\n\nexport const owner = (name: string) => label(LabelName.OWNER, name);\n\nexport const severity = (name: string) => label(LabelName.SEVERITY, name);\n\nexport const layer = (name: string) => label(LabelName.LAYER, name);\n\nexport const tag = (name: string) => label(LabelName.TAG, name);\n\nexport const tags = (...tagsList: string[]) => {\n  return callRuntimeMethod(\"labels\", ...tagsList.map((value) => ({ name: LabelName.TAG, value })));\n};\n"],"mappings":"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","ignoreList":[]}